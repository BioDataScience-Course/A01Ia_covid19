---
title: "Suivi de la vaccination contre le COVID 19 en Belgique"
author: "___"
date: "`r lubridate::today()`"
output:
  html_document: 
    code_folding: hide 
    theme: journal
    highlight: tango
---

<!--# Ceci est un commentaire. Il n'apparait pas dans votre rapport final. Observez la structure balisée par --- ci-dessus. C'est une zone particulière qui renseigne les informations de base du document telles que le titre, l'auteur, la date ou encore le format de sortie du document. Cette zone s'appelle un entête YAML. -->

<!--% Ceci est une consigne. Remplacez author: "___" par votre nom. ex: author: "Engels Guyliann". Attention, l'entête YAML est très sensible aux espaces et aux guillemets..-->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
# Chargement de packages utiles ----
SciViews::R(lang = "fr")
library(lubridate)
# importation des données en local ----
vaccine <- read("../data/be_vaccines_covid.rds")
last_update <- paste0("Mis à jour le " , attr(vaccine, "downloaded"))
```

<!--# Observez les instructions ci-dessus, le code est placé dans une zone particulière que l'on nomme un chunk. Il n'est pas utile de comprendre les instructions. Intéressez-vous plutôt à la succession de zones de texte et aux zones de codes..-->

# Introduction

Ce carnet de notes s'intéresse à la campagne de vaccination qui a débuté le `r min(vaccine$date)` afin de lutter contre le COVID 19.

<!--# Dans le paragraphe ci-dessus, vous pouvez observer que du code R a été intégré au sein du texte. Il s'agit d'une forme de chunk raccourci qui est prévu pour être intégré dans des paragraphes. Cette technique est très utile pour ajouter des éléments contextuels aux données. -->

![Photo by <a href="https://unsplash.com/@cdc?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">CDC</a> on <a href="https://unsplash.com/s/photos/vaccination?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a>](../figures/covid.jpg){width="50%"}

<!--# Vous pouvez observer ci-dessus la syntaxe employée afin d'intégrer une image dans un document R Markdown.-->

*Les analyses proposées ci-dessous utilisent les données datant du `r attr(vaccine, "downloaded")`.*

# Analyses

En Belgique, `r fsum(vaccine$count)` doses de vaccin ont été administrées.

```{r week}
vaccine %>.%
  smutate(., week = floor_date(date,"week", week_start = 1)) %>.%
  sgroup_by(., week) |> ssummarise(tot = fsum(count)) %>.%
  chart(data = ., tot ~ week) +
  geom_point() +
    geom_line() +
    labs(y = "Nombre de doses administrées par semaine", x = "Date")
```

-   Deux vagues de vaccination sont observées via le nombre de vaccinations par semaine au cours du temps.
-   Une troisième vague semble débuter en septembre 2022.

```{r brand}
nb_brand_dose %>.%
  sgroup_by(., brand) |> ssummarise(nb = fsum(nb)) %>.%
  sarrange(., desc(nb)) %->%
  nb_brand

nb_brand
```

Le tableau ci-dessous indique la répartition des vaccins administrés.

<!--% Proposez un élément supplémentaire, sous forme de liste des résultats relatifs à la répartition des vaccins administrés.-->

-   le vaccin le plus administré est le `r ffirst(nb_brand$brand)`.

-   ...

```{r brand_dose}
vaccine %>.%
  sgroup_by(., brand, dose) |> ssummarise(nb = fsum(count)) %>.%
  sarrange(., desc(nb)) %>.%
  spivot_wider(nb_brand_dose, names_from = "dose", values_from = "nb") %>.%
  replace_NA(., value = 0)
```

Le tableau de contingence ci-dessus propose la répartition du nombre de doses de vaccins administrés en Belgique en fonction de la dose administrée. Ces doses sont nommées A, B, C, E, E2, E3. La dose A et B concerne les vaccins qui devaient être pris en 2 injections pour être efficace alors que la dose C correspond au vaccin qui n'en nécessitait qu'une seule. Les doses E, E2 et E3 sont les doses de rappels.

Le nombre des vaccins administrés par sexe est proposé ci-dessous.

```{r brand_sex}
vaccine %>.%
  sgroup_by(., brand, sex) |> ssummarise(nb = fsum(count)) %>.%
  sdrop_na(., sex) %>.%
  sarrange(., desc(nb))
  spivot_wider(., names_from = "sex", values_from = "nb")
```

<!--% Proposez 2 éléments, sous forme de liste des résultats relatifs à la répartition des vaccins administrés par sexe.-->

-   ...

-   ...

La Belgique a encouragé les Belges à se faire administrer des doses de rappels.

```{r age}
# filtrer les données pour ne garder que les secondes doses et troisièmes dose de rappels
vaccine %>.%
 sfilter(., dose %in% c("E2", "E3")) %>.%
 sgroup_by(., agegroup, region) |> ssummarise(
   tot = fsum(count) |> labelise("Nombre de doses administrées")) %->%
 comp_vaccine

comp_vaccine %>.%
 sdrop_na(., region) %>.%
 chart(., tot ~ agegroup %fill=% region) +
   geom_col()
```

Le graphique ci-dessus s'intéresse uniquement aux secondes et troisièmes doses de rappels. La répartition des groupes d'âge est disponible sur le graphique ci-dessous.

<!--% Proposez 2 éléments supplémentaires, sous forme de liste des résultats relatifs à la répartition des vaccins administrés par groupe d'âge.-->

-   On dénombre `r sum(comp_vaccine$vac_tot)` doses de rappels administrées.

-   ...

-   ...
